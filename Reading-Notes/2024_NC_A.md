# 《An ensemble penalized regression method for multi-ancestry polygenic risk prediction》论文综述

## 一、研究问题
如何在**欧洲人群GWAS数据主导**的背景下，构建适用于**多个人群（尤其是非欧洲人群）的多祖先多基因风险评分（PRS）**，以提升其在少数人群中的预测准确性、可迁移性与计算效率？

---

## 二、研究动机
- **现有PRS大多基于欧洲人群训练**，在非洲、东亚、南亚等非欧人群中预测性能显著下降，存在“遗传预测鸿沟”。
- **非欧人群GWAS样本量普遍较小**，单一来源训练难以达到理想效果。
- 现有跨人群方法（如加权PRS、PRS-CSx、CT-SLEB）在**建模灵活性、计算效率或预测稳健性**方面仍有局限。
- 需一种能**同时建模人群内遗传稀疏性和人群间遗传相似性**的高效方法。

---

## 三、研究内容
提出名为 **PROSPER**（Polygenic Risk scOres based on ensemble of PEnalized Regression models）的新方法，核心内容包括：

1. **惩罚回归框架**：结合LASSO（L₁）惩罚控制SNP效应稀疏性，Ridge（L₂）惩罚促进人群间遗传相似性。
2. **参数简化策略**：通过先验单人群分析获取基础参数，显著减少调参数量。
3. **集成学习步骤**：使用超级学习（Super Learner）集成多个调参组合下的PRS，提升模型稳健性。
4. **大规模评估**：在模拟数据和三大真实数据集（23andMe、GLGC、All of Us + UK Biobank）中，与多类现有方法系统比较。

---

## 四、研究方法
1. **数据输入**：多人群GWAS摘要统计 + LD参考矩阵 + 个体层面调优与验证数据。
2. **三步流程**（见图1）：
   - **步骤1**：对各人群分别进行单祖先LASSO回归（lassosum2），获取最优调优参数。
   - **步骤2**：基于惩罚回归进行跨人群联合建模，优化目标函数。
   - **步骤3**：使用超级学习集成不同参数下的PRS，得到最终模型。
3. **优化算法**：坐标下降法迭代求解，支持大规模SNP分析。
4. **评估指标**：
   - 连续性状：R²
   - 二元性状：AUC & logit-scale方差
5. **对比方法**：
   - 单人群方法：CT、LDPred2、lassosum2
   - 基于欧洲PRS的方法
   - 加权PRS方法
   - 先进跨人群方法：PRS-CSx、CT-SLEB

---

## 五、研究结论
1. **PROSPER在多数情况下优于现有方法**，尤其在目标人群样本量较大时（如非洲人群），预测性能显著提升（相比PRS-CSx，R²平均提升70%）。
2. **计算效率高**：相比PRS-CSx，在五人群分析中**快88倍**，内存使用在可接受范围内。
3. **集成学习提升稳健性**：尤其在遗传结构复杂时，集成能有效缓解模型设定偏误。
4. **跨人群建模有效**：通过L₂惩罚建模人群间共享效应，相比仅使用集成学习的加权lassosum2，性能进一步提升。
5. **局限性明显**：
   - 目标人群样本量小且多基因性低时，性能可能不如CT-SLEB或PRS-CSx。
   - 调优样本量不足时，集成易过拟合。
   - 假设人群间遗传相似性均匀，未考虑遗传距离差异。

---

## 六、存在问题与改进方法

| 问题分类 | 具体问题 | 改进方向 |
|:---|:---|:---|
| **方法层面** | 1. LASSO在小样本低多基因性下可能引入偏差<br>2. 集成学习在调优样本少时易过拟合<br>3. 遗传相似性惩罚参数c假设所有人群对相同 | 1. 扩展至**自适应LASSO**或SCAD/MCP惩罚<br>2. 开发**稳健集成策略**（如样本量小时退化为单参数选择）<br>3. 引入**基于遗传距离（如Fst）的加权cᵢⱼ**，或分层惩罚策略 |
| **建模假设** | 1. 基于**离散人群标签**，忽略遗传连续谱<br>2. 假设**强负选择**模型，不符合所有性状<br>3. 仅对**共享SNP**施加跨人群相似性约束 | 1. 扩展至**连续遗传背景建模**（如祖先成分作为连续变量）<br>2. 引入**可调节的选择强度参数**，适配多样遗传架构<br>3. 探索**人群特异性变异的跨人群信息借用机制** |
| **数据依赖** | 1. 依赖**高质量、人群匹配的LD参考面板**<br>2. 需要**各人群个体层面调优数据**，实践中难获取<br>3. 商业数据（如23andMe）限制方法更新与完整比较 | 1. 整合**更大规模多样性参考面板**（如TOPMed）<br>2. 开发**仅需摘要统计或极小样本的调优策略**<br>3. 在**公开数据集上加强基准测试与版本同步** |
| **可扩展性** | 1. 未针对**极大规模基因组**（如全基因组测序数据）优化<br>2. 未充分探索**非线性集成方法**（如 stacking 与深度学习元学习器） | 1. 开发**分块并行、内存优化的版本**<br>2. 尝试**更灵活的元学习框架**，提升集成表达能力 |
| **科学伦理** | 1. **性能差距根源未完全厘清**（方法偏倚 vs. 数据偏倚）<br>2. **人群标签的伦理与科学合理性**未深入讨论 | 1. 设计实验**量化两种偏倚的贡献**<br>2. 在方法与文档中强调**人群标签的局限性与社会敏感性** |

---

## 总结
PROSPER是一种**在预测性能、计算效率与稳健性之间取得良好平衡的多祖先PRS新方法**。它通过**惩罚回归+集成学习**的框架，显著推动了跨人群遗传预测的发展。其**主要的改进空间在于提升对小样本/低多基因性状的适应性、建模连续遗传背景、降低对个体调优数据的依赖，并增强在大规模、多样化数据场景下的可扩展性**。未来的工作应致力于构建**更灵活、更稳健、更具包容性的下一代多祖先PRS框架**。
