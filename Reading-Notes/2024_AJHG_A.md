# 《shaPRS: Leveraging shared genetic effects across traits or ancestries improves accuracy of polygenic scores》论文分析

## 一、研究问题
如何**提高多基因风险评分（PRS）的准确性**，尤其是在以下两种场景中：

1. **跨性状场景**：利用两种部分相关的疾病（如克罗恩病与溃疡性结肠炎）之间的遗传重叠；
2. **跨祖先场景**：利用不同祖先群体（如欧洲与东亚、非洲与欧洲）之间的共享遗传效应。

---

## 二、研究动机
- **PRS 的临床潜力受限**：当前GWAS样本量不足，尤其对罕见病和小样本群体，导致PRS预测精度低。
- **遗传学研究存在多样性鸿沟**：94.5%的GWAS样本来自欧洲人群，限制了PRS在非欧洲人群中的适用性。
- **共享遗传效应广泛存在**：多种疾病或祖先群体之间存在部分共享的遗传基础，但现有方法未充分考虑遗传效应的**异质性分布**（即某些SNP效应共享，某些不共享）。

---

## 三、研究内容
- 提出 **shaPRS**（发音为“shapers”）方法，作为PRS生成流程的**预处理步骤**。
- **核心思想**：根据两个数据集（“近端”与“辅助”）在每个SNP上的效应异质性，动态决定是否合并信息：
  - 若效应同质（高IFDR），则合并信息以降低方差；
  - 若效应异质（低IFDR），则优先使用近端数据集以避免偏倚。
- **两大应用场景**：
  1. 跨性状：如IBD亚型（CD与UC）；
  2. 跨祖先：如利用欧洲GWAS辅助提高非洲或东亚人群的PRS准确性。

---

## 四、研究方法
1. **异质性检验**：
   - 使用 Cochran’s Q 检验评估两个数据集在每个SNP上的效应差异；
   - 通过局部错误发现率（IFDR）量化“共享真实效应”的概率。

2. **效应融合公式**：
   $\[
   \beta_{\text{shaPRS}} = \pi \beta_{12} + (1-\pi) \beta_1
   \]$
   - $\(\pi\)$ 为IFDR，$\(\beta_{12}\)$ 为合并效应估计，$\(\beta_1\)$ 为近端效应。

3. **LD矩阵重构**：
   - 生成适用于融合后效应估计的SNP相关矩阵，支持跨祖先LD差异。

4. **评估策略**：
   - **模拟研究**：在UK Biobank中模拟不同遗传相关性、样本量、共享结构场景。
   - **真实数据应用**：
     - 跨性状：CD与UC；
     - 跨祖先：欧洲-东亚、欧洲-非洲。

5. **对比方法**：
   - 单数据集、固定效应meta分析、SMTPred、MTAG、PRS-CSx等。

---

## 五、研究结论
- **shaPRS 显著提升PRS准确性**：
  - 在93%的模拟场景中优于现有方法；
  - 在CD/UC分析中，比meta分析提升6–12%，比SMTPred提升7–10%；
  - 在跨祖先分析中，在6/8个性状上优于PRS-CSx。

- **关键优势**：
  - 能**自适应地处理SNP级别的异质性**；
  - 无需额外基因型验证数据，适用于资源有限的群体；
  - 与现有PRS生成工具（如LDPred2、PRS-CS）兼容。

---

## 六、存在问题与改进建议

### 存在问题：
1. **依赖SNP重叠**：shaPRS要求SNP在两个数据集中均有基因型数据，可能限制其在低重叠SNP数据集中的应用。
2. **仅支持两两比较**：当前仅支持两个数据集融合，未扩展到多个数据集。
3. **IFDR估计依赖分布假设**：依赖于Q检验的p值分布，可能在某些遗传结构下估计不准。
4. **计算复杂度**：需为每个SNP计算IFDR并重构LD矩阵，可能在大规模数据中增加计算负担。
5. **未考虑环境或性别异质性**：仅关注遗传异质性，未整合环境或性别特异性效应。

### 改进建议：
1. **扩展至多数据集融合**：开发支持三个及以上数据集融合的版本，进一步提升信息整合能力。
2. **优化IFDR估计**：引入更稳健的贝叶斯方法或深度学习模型估计异质性概率。
3. **支持低重叠SNP场景**：结合基因型插补或区域级效应共享策略，提高方法适用性。
4. **整合环境与性别信息**：扩展模型以处理环境-基因交互或性别特异性遗传效应。
5. **开发GPU加速版本**：优化算法实现，支持大规模GWAS数据快速处理。
