### [多基因评分](https://zhuanlan.zhihu.com/p/368701300)

多基因评分（Polygenic Scores，简称PGS）是与特定性状（包括行为、特征或疾病）相关的有效等位基因作用（即遗传基因影响）的加权和，可用于估计一个人出现某种生理/心理特征、罹患某种疾病的风险。

### [连锁不平衡与基因座](https://gwaslab.org/2021/04/04/%e8%bf%9e%e9%94%81%e4%b8%8d%e5%b9%b3%e8%a1%a1-linkage-disequilibrium-ld/)

连锁不平衡（linkage disequilibrium LD）是指不同基因座（loci）的等位基因（Allele）之间非随机（Nonrandom）的关联。基因座与等位基因之间的关系是，基因座是指染色体上的位置，而等位基因则是在该位置上可能存在的不同版本的基因，每个基因座上都有两个等位基因，一个来自父亲一个来自母亲。

### [SNP](https://zhuanlan.zhihu.com/p/45883568)

### SNP （单核苷酸多态性 Single Nucleotide Polymorphism）主要是指在基因组水平上由单个核苷酸的变异所引起的DNA序列多样性，其数量很多，多态性丰富。一般而言,SNP 是指变异频率大于1 %的单核苷酸变异。

### [热编码](https://zhuanlan.zhihu.com/p/134495345)

One hot编码是一种将分类变量转换为数值变量的方法。在热编码中，每个分类变量被转换为一个新的二进制变量，其中只有一个变量的值为1，其余变量的值为0。这个被编码的变量的值决定了哪个二进制变量的值为1。热编码通常用于机器学习中的特征工程，以便将分类变量用于模型训练。文章中，热编码被用于将变异体编码为其基因型类别的存在或缺失

### [协变量](https://zhuanlan.zhihu.com/p/159335088)

在回归分析中，协变量（Covariate）通常是一个连续的自变量，但它也可以是一个分类变量或二元变量。使用协变量可以减少其他自变量对因变量的估计影响，从而更准确地估计它们之间的关系。例如，如果研究某个药物对血压的影响，协变量可以是患者的年龄、性别、体重等因素，以控制这些因素的影响，从而更准确地估计药物对血压的影响。
协变量的选择对于研究的结果非常重要。如果没有正确地选择协变量，可能会导致结果偏差，掩盖真实的关系或者产生虚假的关系。在选择协变量时，需要根据研究的特点和理论考虑，同时需要进行统计检验以评估协变量对结果的影响。

### P-value

计算PGS时，PLINK 软件可以计算每个个体的Risk score，并且根据设定的阈值计算出与某个表型（如疾病）的关联。PLINK的PGS计算结果中包含了一个p-value，它可以用于衡量每个个体的risk score与某个表型的关联强度。它实际上代表了个体的 risk score与表型之间的相关性程度。p-value 越小，说明个体的risk score 与表型之间的关联越强。一般情况下，当p-value小于=0.05时，就被认为是极显著的结果，表明个体的risk score与表型之间存在着显著的关联性。


### R²系数

模型的拟合程度。R²系数的计算基于线性回归分析，指的是模型解释的变异总和占总变异总和的比例。R²系数越高，模型的拟合程度就越好，解释能力也就越强。R²系数只适用于线性回归模型。

### R²的计算

 1. 首先计算实际观测值y的平均值y_mean。
 2. 然后计算模型预测值y_pred与实际观测值y之间的平方和SS_res，即： SS_res = Σ(y - y_pred)² 
 3. 再计算实际观测值y与平均值y_mean之间的平方和SS_tot，即： SS_tot = Σ(y - y_mean)² 
 4. 最后，R2系数的计算公式为： R2 = 1 - (SS_res / SS_tot) 其中，R2系数的取值范围为0到1，越接近1表示模型的拟合优度越好。
 
### [Spearman相关系数](https://mengte.online/archives/1879)
Pearson相关性分析主要用于分析满足正态分布的两定量变量之间的关系，Spearman相关系数(rs)介于-1与1之间，rs >0为正相关，rs <0为负相关。rs的绝对值(|rs|)越大，变量间的相关性越强。

### Rs 计算
1. 首先将两个变量的观测值按照大小排序，得到它们的秩次。
2.  然后计算两个变量的秩次之间的Spearman等级相关系数，即： Rs = 1 - (6Σd² / n(n²-1)) 其中，d为两个变量在秩次上的差值，n为样本数量。
3. Rs的取值范围为-1到1，其中1表示两个变量完全正相关，-1表示两个变量完全负相关，0表示两个变量之间没有线性相关性。

### [P+T](https://zhuanlan.zhihu.com/p/373217037)

从总的SNP数据中，基于SNP两两之间的LD，来抽取出一个不含互相关联SNP的子集。

Pruning：选取第一个SNP，然后计算这个SNP与窗口区间里第二个，第三个，等等的r2，当检测到高的相关性时，就会从这一对SNP中去除MAF较低的那个，保留 MAF 高的，也就是说这个过程中可能会去除掉我们选的第一个SNP。完成后下一步就是选取下一个SNP，重复这个过程。

Clumping：首先会依据从GWAS得到的p值对SNP的重要性进行排序，然后选取排序后的第一个SNP， 计算这个SNP与 窗口区间里 其他SNP的r2， 当检测到高的相关性时，就会从这一对SNP中去除重要性低的那个， 这个过程中我们选的第一个SNP一定会得到保留。 完成后下一步就是选取 p值 排序后的下一个 SNP，重复这个过程。


